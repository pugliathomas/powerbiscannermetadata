{"name":"bronzeScannerPostActivityAPI_IncrementalRefresh","description":"","version":"1.0","culture":"en-US","modifiedTime":"2022-11-10T03:31:43.511582+00:00","ppdf:outputFileFormat":"Csv","pbi:mashup":{"fastCombine":true,"allowNativeQueries":false,"queriesMetadata":{"client_id":{"queryId":"4d8af51f-0123-4a91-a250-318144195239","queryName":"client_id","queryGroupId":"40ddf872-7938-4986-903f-0455b6657d6b"},"client_secret":{"queryId":"b803f1d3-bc0e-4b9e-a158-506449c3f93f","queryName":"client_secret","queryGroupId":"40ddf872-7938-4986-903f-0455b6657d6b"},"tenant_id":{"queryId":"b1a57c8b-281d-413b-b7dc-ba165eba5bf1","queryName":"tenant_id","queryGroupId":"40ddf872-7938-4986-903f-0455b6657d6b"},"GetToken":{"queryId":"4ef528fa-acac-42f9-b1e8-483bfe7dcc5a","queryName":"GetToken","queryGroupId":"40ddf872-7938-4986-903f-0455b6657d6b"},"wsbody":{"queryId":"f2d95378-2f48-4ee6-b2d3-25dd7721e21d","queryName":"wsbody","queryGroupId":"40ddf872-7938-4986-903f-0455b6657d6b"},"getScanID":{"queryId":"acd51b86-d5ee-4ca0-b790-bd79c44ce112","queryName":"getScanID","queryGroupId":"50ca40b4-d121-490d-ada5-30a6efc5fac0"},"Column1 id":{"queryId":"30b4b3d1-9b55-442d-b685-35c2d551d365","queryName":"Column1 id","queryGroupId":"50ca40b4-d121-490d-ada5-30a6efc5fac0"},"WorkspaceList":{"queryId":"bacb4230-7bdc-4696-acad-35abd00d1891","queryName":"WorkspaceList","queryGroupId":"50ca40b4-d121-490d-ada5-30a6efc5fac0","loadEnabled":true},"scanResults":{"queryId":"67eb467c-0ff8-4c99-a482-2df6b043e4fc","queryName":"scanResults","queryGroupId":"50ca40b4-d121-490d-ada5-30a6efc5fac0","loadEnabled":true},"getScanIDWS":{"queryId":"e963147c-5d3b-472e-b9b3-c5e9a4a224ad","queryName":"getScanIDWS","queryGroupId":"50ca40b4-d121-490d-ada5-30a6efc5fac0","loadEnabled":true},"AmountOfDays":{"queryId":"505135ea-523e-4b68-bc71-60b1878e6122","queryName":"AmountOfDays","queryGroupId":"72b09c02-e9d7-4cfa-b355-33e3790eb128"},"StartDate":{"queryId":"c13c2da3-29c7-46a2-b26f-6567140e3337","queryName":"StartDate","queryGroupId":"72b09c02-e9d7-4cfa-b355-33e3790eb128"},"EndDate":{"queryId":"e858beda-ee60-48c0-8c88-71f1d0b29968","queryName":"EndDate","queryGroupId":"72b09c02-e9d7-4cfa-b355-33e3790eb128"},"GetActivityManual":{"queryId":"e89abe98-65d5-4cd7-8d16-2dd7dd3cc441","queryName":"GetActivityManual","queryGroupId":"72b09c02-e9d7-4cfa-b355-33e3790eb128"},"GetActivityBasicLoad":{"queryId":"798ae63c-6d6d-4e6c-8b2c-2efbb0a8f8e0","queryName":"GetActivityBasicLoad","queryGroupId":"72b09c02-e9d7-4cfa-b355-33e3790eb128"},"GetActivityContinuationToken":{"queryId":"195fbce5-114c-4db7-b535-6585b63464d8","queryName":"GetActivityContinuationToken","queryGroupId":"72b09c02-e9d7-4cfa-b355-33e3790eb128"},"LoadActivityManual":{"queryId":"96f5015a-efc6-4be2-9e27-d5526860acc2","queryName":"LoadActivityManual","queryGroupId":"72b09c02-e9d7-4cfa-b355-33e3790eb128"},"ActivityManual":{"queryId":"34ab2473-535f-4660-b89c-a622dd0b612e","queryName":"ActivityManual","queryGroupId":"72b09c02-e9d7-4cfa-b355-33e3790eb128","loadEnabled":true},"RangeEnd":{"queryId":"27a93e04-ba1f-49d5-ada6-6dd9eb96b1c6","queryName":"RangeEnd"},"RangeStart":{"queryId":"dcce9a24-6cda-4b76-b17c-756f41562d41","queryName":"RangeStart"}},"document":"section Section1;\r\n\r\nshared client_id = \"a35929cb-f3e6-4f0a-b47d-00b069906d99\" meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = type any];\r\n\r\nshared client_secret = \"CVh7Q~Axzi~ZMfZISblWD8_geYKbf39_Xx3Kd\" meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = type any];\r\n\r\nshared tenant_id = \"8c39a7ff-e077-4d1c-9a1c-7431fe5eb465\" meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = type any];\r\n\r\nshared GetToken = let\r\n    Source = () =>\r\n    let\r\n    body = \"grant_type=client_credentials&resource=https://analysis.windows.net/powerbi/api&client_id=\"&client_id&\"&client_secret=\"&client_secret,\r\n    Data=Json.Document(Web.Contents(\"https://login.microsoftonline.com/\"&tenant_id&\"/oauth2/token\", [Headers=[#\"Content-Type\"=\"application/x-www-form-urlencoded\"], Content=Text.ToBinary(body)])),\r\n    access_token = Data[access_token]\r\nin\r\n    access_token\r\nin\r\n    Source;\r\n\r\nshared wsbody = let\r\n    JSV = Json.FromValue([workspaces = #\"Column1 id\"]),\r\n    JSONToTextOne = Table.FromColumns({Lines.FromBinary(JSV, null, null, 1252)}),\r\n    TextOnly = JSONToTextOne{0}[Column1]\r\nin\r\n    TextOnly;\r\n\r\nshared getScanID = let\r\n    Data = Json.Document(Web.Contents(\"https://api.powerbi.com/v1.0/myorg/\",\r\n    [\r\n    RelativePath= \"admin/workspaces/modified?excludePersonalWorkspaces=True\",\r\n    Headers=[Authorization=\"Bearer \" & GetToken()]\r\n    ]\r\n    )),\r\n    #\"Converted to Table\" = Table.FromList(Data, Splitter.SplitByNothing(), null, null, ExtraValues.Error),\r\n    exo = Table.ExpandRecordColumn(#\"Converted to Table\", \"Column1\", {\"id\"}, {\"Column1.id\"}),\r\n    PostWSContent = Web.Contents(\"https://api.powerbi.com/v1.0/myorg/admin/workspaces/getInfo?lineage=True&datasourceDetails=True&datasetSchema=true&datasetExpressions=true&getArtifactUsers=true\",\r\n    [\r\n    Headers=[Authorization=\"Bearer \" & GetToken(),\r\n    #\"Content-Type\"=\"application/json\"\r\n    ],\r\n    Content =  Text.ToBinary(wsbody)]),\r\n    #\"Renamed Columns\" = Table.RenameColumns(exo,{{\"Column1.id\", \"workspaceID\"}}),\r\n    #\"Changed Type\" = Table.TransformColumnTypes(#\"Renamed Columns\",{{\"workspaceID\", type text}}),\r\n    exoN = Table.AddColumn( #\"Changed Type\", \"NN\", each Json.Document(PostWSContent))\r\nin\r\n    exoN;\r\n\r\nshared #\"Column1 id\" = let\r\n    Data = Json.Document(Web.Contents(\"https://api.powerbi.com/v1.0/myorg/\",\r\n    [\r\n    RelativePath= \"admin/workspaces/modified?excludePersonalWorkspaces=True\",\r\n    Headers=[Authorization=\"Bearer \" & GetToken()]\r\n    ]\r\n    )),\r\n    #\"Converted to Table\" = Table.FromList(Data, Splitter.SplitByNothing(), null, null, ExtraValues.Error),\r\n    #\"Expanded Column1\" = Table.ExpandRecordColumn(#\"Converted to Table\", \"Column1\", {\"id\"}, {\"Column1.id\"}),\r\n    #\"Column1 id1\" = #\"Expanded Column1\"[Column1.id]\r\nin\r\n    #\"Column1 id1\";\r\n\r\nshared WorkspaceList = let\r\n    Data = Json.Document(Web.Contents(\"https://api.powerbi.com/v1.0/myorg/\",\r\n    [\r\n    RelativePath= \"admin/workspaces/modified?excludePersonalWorkspaces=True\",\r\n    Headers=[Authorization=\"Bearer \" & GetToken()]\r\n    ]\r\n    )),\r\n    #\"Converted to Table\" = Table.FromList(Data, Splitter.SplitByNothing(), null, null, ExtraValues.Error),\r\n    exo = Table.ExpandRecordColumn(#\"Converted to Table\", \"Column1\", {\"id\"}, {\"Column1.id\"}),\r\n    #\"Changed Type\" = Table.TransformColumnTypes(exo,{{\"Column1.id\", type text}})\r\nin\r\n    #\"Changed Type\";\r\n\r\nshared scanResults = let\r\n    Data = getScanID[NN],\r\n    Data1 = Data{0},\r\n    #\"Converted to Table\" = Record.ToTable(Data1),\r\n    #\"Transform columns\" = Table.TransformColumnTypes(#\"Converted to Table\", {{\"Value\", type text}}),\r\n    #\"Replace errors\" = Table.ReplaceErrorValues(#\"Transform columns\", {{\"Value\", null}})\r\nin\r\n    #\"Replace errors\";\r\n\r\nshared getScanIDWS = let\r\n    Source = getScanID,\r\n    #\"Expanded NN\" = Table.ExpandRecordColumn(Source, \"NN\", {\"id\", \"createdDateTime\", \"status\"}, {\"id\", \"createdDateTime\", \"status\"}),\r\n    #\"Changed Type\" = Table.TransformColumnTypes(#\"Expanded NN\",{{\"id\", type text}, {\"createdDateTime\", type datetime}, {\"status\", type text}})\r\nin\r\n    #\"Changed Type\";\r\n\r\nshared AmountOfDays = 20 meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = type any];\r\n\r\nshared StartDate = \"'2022-09-25T00:00:00.000Z'\" meta [IsParameterQuery=true, Type=\"Any\", IsParameterQueryRequired=true];\r\n\r\nshared EndDate = \"'2022-09-25T23:59:59.000Z'\" meta [IsParameterQuery=true, Type=\"Any\", IsParameterQueryRequired=true];\r\n\r\nshared GetActivityManual = let\r\n    Source = (StartDate as any, EndDate as any) => let\r\n    BasicQuery= GetActivityBasicLoad(StartDate, EndDate),\r\n    ContinuationQuery_01 = GetActivityContinuationToken( BasicQuery[continuationToken] ),\r\n    ContinuationQuery_02 = GetActivityContinuationToken( ContinuationQuery_01[continuationToken] ),\r\n    ContinuationQuery_03 = GetActivityContinuationToken( ContinuationQuery_02[continuationToken] ),\r\n    ContinuationQuery_04 = GetActivityContinuationToken( ContinuationQuery_03[continuationToken] ),\r\n    ContinuationQuery_05 = GetActivityContinuationToken( ContinuationQuery_04[continuationToken] ),\r\n    ContinuationQuery_06 = GetActivityContinuationToken( ContinuationQuery_05[continuationToken] ),\r\n    ContinuationQuery_07 = GetActivityContinuationToken( ContinuationQuery_06[continuationToken] ),\r\n    ContinuationQuery_08 = GetActivityContinuationToken( ContinuationQuery_07[continuationToken] ),\r\n    ContinuationQuery_09 = GetActivityContinuationToken( ContinuationQuery_08[continuationToken] ),\r\n    ContinuationQuery_10 = GetActivityContinuationToken( ContinuationQuery_09[continuationToken] ),\r\n    ContinuationQuery_11 = GetActivityContinuationToken( ContinuationQuery_10[continuationToken] ),\r\n    ContinuationQuery_12 = GetActivityContinuationToken( ContinuationQuery_11[continuationToken] ),\r\n    ContinuationQuery_13 = GetActivityContinuationToken( ContinuationQuery_12[continuationToken] ),\r\n    ContinuationQuery_14 = GetActivityContinuationToken( ContinuationQuery_13[continuationToken] ),\r\n    ContinuationQuery_15 = GetActivityContinuationToken( ContinuationQuery_14[continuationToken] ),\r\n    ContinuationQuery_16 = GetActivityContinuationToken( ContinuationQuery_15[continuationToken] ),\r\n    ContinuationQuery_17 = GetActivityContinuationToken( ContinuationQuery_16[continuationToken] ),\r\n    ContinuationQuery_18 = GetActivityContinuationToken( ContinuationQuery_17[continuationToken] ),\r\n    ContinuationQuery_19 = GetActivityContinuationToken( ContinuationQuery_18[continuationToken] ),\r\n    ContinuationQuery_20 = GetActivityContinuationToken( ContinuationQuery_19[continuationToken] ),\r\n    ContinuationQuery_21 = GetActivityContinuationToken( ContinuationQuery_20[continuationToken] ),\r\n    ContinuationQuery_22 = GetActivityContinuationToken( ContinuationQuery_21[continuationToken] ),\r\n    ContinuationQuery_23 = GetActivityContinuationToken( ContinuationQuery_22[continuationToken] ),\r\n    ContinuationQuery_24 = GetActivityContinuationToken( ContinuationQuery_23[continuationToken] ),\r\n    ContinuationQuery_25 = GetActivityContinuationToken( ContinuationQuery_24[continuationToken] ),\r\n    ContinuationQuery_26 = GetActivityContinuationToken( ContinuationQuery_25[continuationToken] ),\r\n    ContinuationQuery_27 = GetActivityContinuationToken( ContinuationQuery_26[continuationToken] ),\r\n    ContinuationQuery_28 = GetActivityContinuationToken( ContinuationQuery_27[continuationToken] ),\r\n    ContinuationQuery_29 = GetActivityContinuationToken( ContinuationQuery_28[continuationToken] ),\r\n    ContinuationQuery_30 = GetActivityContinuationToken( ContinuationQuery_29[continuationToken] ),\r\n    ContinuationQuery_31 = GetActivityContinuationToken( ContinuationQuery_30[continuationToken] ),\r\n    ContinuationQuery_32 = GetActivityContinuationToken( ContinuationQuery_31[continuationToken] ),\r\n    ContinuationQuery_33 = GetActivityContinuationToken( ContinuationQuery_32[continuationToken] ),\r\n    ContinuationQuery_34 = GetActivityContinuationToken( ContinuationQuery_33[continuationToken] ),\r\n    ContinuationQuery_35 = GetActivityContinuationToken( ContinuationQuery_34[continuationToken] ),\r\n    ContinuationQuery_36 = GetActivityContinuationToken( ContinuationQuery_35[continuationToken] ),\r\n    ContinuationQuery_37 = GetActivityContinuationToken( ContinuationQuery_36[continuationToken] ),\r\n    ContinuationQuery_38 = GetActivityContinuationToken( ContinuationQuery_37[continuationToken] ),\r\n    ContinuationQuery_39 = GetActivityContinuationToken( ContinuationQuery_38[continuationToken] ),\r\n    ContinuationQuery_40 = GetActivityContinuationToken( ContinuationQuery_39[continuationToken] ),\r\n    ContinuationQuery_41 = GetActivityContinuationToken( ContinuationQuery_40[continuationToken] ),\r\n    ContinuationQuery_42 = GetActivityContinuationToken( ContinuationQuery_41[continuationToken] ),\r\n    ContinuationQuery_43 = GetActivityContinuationToken( ContinuationQuery_42[continuationToken] ),\r\n    ContinuationQuery_44 = GetActivityContinuationToken( ContinuationQuery_43[continuationToken] ),\r\n    ContinuationQuery_45 = GetActivityContinuationToken( ContinuationQuery_44[continuationToken] ),\r\n    ContinuationQuery_46 = GetActivityContinuationToken( ContinuationQuery_45[continuationToken] ),\r\n    ContinuationQuery_47 = GetActivityContinuationToken( ContinuationQuery_46[continuationToken] ),\r\n    ContinuationQuery_48 = GetActivityContinuationToken( ContinuationQuery_47[continuationToken] ),\r\n    ContinuationQuery_49 = GetActivityContinuationToken( ContinuationQuery_48[continuationToken] ),\r\n    ContinuationQuery_50 = GetActivityContinuationToken( ContinuationQuery_49[continuationToken] ),\r\n    ContinuationQuery_51 = GetActivityContinuationToken( ContinuationQuery_50[continuationToken] ),\r\n    ContinuationQuery_52 = GetActivityContinuationToken( ContinuationQuery_51[continuationToken] ),\r\n    ContinuationQuery_53 = GetActivityContinuationToken( ContinuationQuery_52[continuationToken] ),\r\n    ContinuationQuery_54 = GetActivityContinuationToken( ContinuationQuery_53[continuationToken] ),\r\n    ContinuationQuery_55 = GetActivityContinuationToken( ContinuationQuery_54[continuationToken] ),\r\n    ContinuationQuery_56 = GetActivityContinuationToken( ContinuationQuery_55[continuationToken] ),\r\n    ContinuationQuery_57 = GetActivityContinuationToken( ContinuationQuery_56[continuationToken] ),\r\n    ContinuationQuery_58 = GetActivityContinuationToken( ContinuationQuery_57[continuationToken] ),\r\n    ContinuationQuery_59 = GetActivityContinuationToken( ContinuationQuery_58[continuationToken] ),\r\n    ContinuationQuery_60 = GetActivityContinuationToken( ContinuationQuery_59[continuationToken] ),\r\n    ContinuationQuery_61 = GetActivityContinuationToken( ContinuationQuery_60[continuationToken] ),\r\n    ContinuationQuery_62 = GetActivityContinuationToken( ContinuationQuery_61[continuationToken] ),\r\n    ContinuationQuery_63 = GetActivityContinuationToken( ContinuationQuery_62[continuationToken] ),\r\n    ContinuationQuery_64 = GetActivityContinuationToken( ContinuationQuery_63[continuationToken] ),\r\n    ContinuationQuery_65 = GetActivityContinuationToken( ContinuationQuery_64[continuationToken] ),\r\n    ContinuationQuery_66 = GetActivityContinuationToken( ContinuationQuery_65[continuationToken] ),\r\n    ContinuationQuery_67 = GetActivityContinuationToken( ContinuationQuery_66[continuationToken] ),\r\n    ContinuationQuery_68 = GetActivityContinuationToken( ContinuationQuery_67[continuationToken] ),\r\n    ContinuationQuery_69 = GetActivityContinuationToken( ContinuationQuery_68[continuationToken] ),\r\n    ContinuationQuery_70 = GetActivityContinuationToken( ContinuationQuery_69[continuationToken] ),\r\n    ContinuationQuery_71 = GetActivityContinuationToken( ContinuationQuery_70[continuationToken] ),\r\n    ContinuationQuery_72 = GetActivityContinuationToken( ContinuationQuery_71[continuationToken] ),\r\n    ContinuationQuery_73 = GetActivityContinuationToken( ContinuationQuery_72[continuationToken] ),\r\n    ContinuationQuery_74 = GetActivityContinuationToken( ContinuationQuery_73[continuationToken] ),\r\n    ContinuationQuery_75 = GetActivityContinuationToken( ContinuationQuery_74[continuationToken] ),\r\n    Result = List.Union(\r\n    {\r\n    BasicQuery[activityEventEntities],\r\n    ContinuationQuery_01[activityEventEntities],\r\n    ContinuationQuery_02[activityEventEntities],\r\n    ContinuationQuery_03[activityEventEntities],\r\n    ContinuationQuery_04[activityEventEntities],\r\n    ContinuationQuery_05[activityEventEntities],\r\n    ContinuationQuery_06[activityEventEntities],\r\n    ContinuationQuery_07[activityEventEntities],\r\n    ContinuationQuery_08[activityEventEntities],\r\n    ContinuationQuery_09[activityEventEntities],\r\n    ContinuationQuery_10[activityEventEntities],\r\n    ContinuationQuery_11[activityEventEntities],\r\n    ContinuationQuery_12[activityEventEntities],\r\n    ContinuationQuery_13[activityEventEntities],\r\n    ContinuationQuery_14[activityEventEntities],\r\n    ContinuationQuery_15[activityEventEntities],\r\n    ContinuationQuery_16[activityEventEntities],\r\n    ContinuationQuery_17[activityEventEntities],\r\n    ContinuationQuery_18[activityEventEntities],\r\n    ContinuationQuery_19[activityEventEntities],\r\n    ContinuationQuery_20[activityEventEntities],\r\n    ContinuationQuery_21[activityEventEntities],\r\n    ContinuationQuery_22[activityEventEntities],\r\n    ContinuationQuery_23[activityEventEntities],\r\n    ContinuationQuery_24[activityEventEntities],\r\n    ContinuationQuery_25[activityEventEntities],\r\n    ContinuationQuery_26[activityEventEntities],\r\n    ContinuationQuery_27[activityEventEntities],\r\n    ContinuationQuery_28[activityEventEntities],\r\n    ContinuationQuery_29[activityEventEntities],\r\n    ContinuationQuery_30[activityEventEntities],\r\n    ContinuationQuery_31[activityEventEntities],\r\n    ContinuationQuery_32[activityEventEntities],\r\n    ContinuationQuery_33[activityEventEntities],\r\n    ContinuationQuery_34[activityEventEntities],\r\n    ContinuationQuery_35[activityEventEntities],\r\n    ContinuationQuery_36[activityEventEntities],\r\n    ContinuationQuery_37[activityEventEntities],\r\n    ContinuationQuery_38[activityEventEntities],\r\n    ContinuationQuery_39[activityEventEntities],\r\n    ContinuationQuery_40[activityEventEntities],\r\n    ContinuationQuery_41[activityEventEntities],\r\n    ContinuationQuery_42[activityEventEntities],\r\n    ContinuationQuery_43[activityEventEntities],\r\n    ContinuationQuery_44[activityEventEntities],\r\n    ContinuationQuery_45[activityEventEntities],\r\n    ContinuationQuery_46[activityEventEntities],\r\n    ContinuationQuery_47[activityEventEntities],\r\n    ContinuationQuery_48[activityEventEntities],\r\n    ContinuationQuery_49[activityEventEntities],\r\n    ContinuationQuery_50[activityEventEntities],\r\n    ContinuationQuery_51[activityEventEntities],\r\n    ContinuationQuery_52[activityEventEntities],\r\n    ContinuationQuery_53[activityEventEntities],\r\n    ContinuationQuery_54[activityEventEntities],\r\n    ContinuationQuery_55[activityEventEntities],\r\n    ContinuationQuery_56[activityEventEntities],\r\n    ContinuationQuery_57[activityEventEntities],\r\n    ContinuationQuery_58[activityEventEntities],\r\n    ContinuationQuery_59[activityEventEntities],\r\n    ContinuationQuery_60[activityEventEntities],\r\n    ContinuationQuery_61[activityEventEntities],\r\n    ContinuationQuery_62[activityEventEntities],\r\n    ContinuationQuery_63[activityEventEntities],\r\n    ContinuationQuery_64[activityEventEntities],\r\n    ContinuationQuery_65[activityEventEntities],\r\n    ContinuationQuery_66[activityEventEntities],\r\n    ContinuationQuery_67[activityEventEntities],\r\n    ContinuationQuery_68[activityEventEntities],\r\n    ContinuationQuery_69[activityEventEntities],\r\n    ContinuationQuery_70[activityEventEntities],\r\n    ContinuationQuery_71[activityEventEntities],\r\n    ContinuationQuery_72[activityEventEntities],\r\n    ContinuationQuery_73[activityEventEntities],\r\n    ContinuationQuery_74[activityEventEntities],\r\n    ContinuationQuery_75[activityEventEntities]\r\n    }\r\n    ),\r\n    #\"Converted to Table\" = Table.FromList(Result, Splitter.SplitByNothing(), null, null, ExtraValues.Error),\r\n    #\"Check if Table is Empty\"= Table.IsEmpty(#\"Converted to Table\"),\r\n    #\"Choose empty or filled table\" = if\r\n    Table.IsEmpty(#\"Converted to Table\")\r\n    then\r\n    #table(\r\n    { \"Id\", \"RecordType\", \"CreationTime\", \"Operation\", \"OrganizationId\", \"UserType\", \"UserKey\", \"Workload\", \"UserId\", \"ClientIP\", \"UserAgent\", \"Activity\", \"ItemName\", \"WorkSpaceName\", \"DatasetName\", \"ReportName\", \"WorkspaceId\", \"ObjectId\", \"DatasetId\", \"ReportId\", \"IsSuccess\", \"ReportType\", \"RequestId\", \"ActivityId\", \"DistributionMethod\", \"ConsumptionMethod\"},\r\n    {}\r\n    )\r\n    else\r\n    Table.ExpandRecordColumn(#\"Converted to Table\", \"Column1\", {\"Id\", \"RecordType\", \"CreationTime\", \"Operation\", \"OrganizationId\", \"UserType\", \"UserKey\", \"Workload\", \"UserId\", \"ClientIP\", \"UserAgent\", \"Activity\", \"ItemName\", \"WorkSpaceName\", \"DatasetName\", \"ReportName\", \"WorkspaceId\", \"ObjectId\", \"DatasetId\", \"ReportId\", \"IsSuccess\", \"ReportType\", \"RequestId\", \"ActivityId\", \"DistributionMethod\", \"ConsumptionMethod\"}, {\"Id\", \"RecordType\", \"CreationTime\", \"Operation\", \"OrganizationId\", \"UserType\", \"UserKey\", \"Workload\", \"UserId\", \"ClientIP\", \"UserAgent\", \"Activity\", \"ItemName\", \"WorkSpaceName\", \"DatasetName\", \"ReportName\", \"WorkspaceId\", \"ObjectId\", \"DatasetId\", \"ReportId\", \"IsSuccess\", \"ReportType\", \"RequestId\", \"ActivityId\", \"DistributionMethod\", \"ConsumptionMethod\"})\r\nin\r\n    #\"Choose empty or filled table\"\r\nin\r\n    Source;\r\n\r\nshared GetActivityBasicLoad = let\r\n    Source = (startDate as text, endDate as text) =>\r\n    let\r\n    Source = Json.Document(Web.Contents(\"https://api.powerbi.com/v1.0/myorg/\",\r\n    [\r\n    RelativePath= \"admin/activityevents?startDateTime=\" & startDate & \"&endDateTime=\" & endDate,\r\n    Headers=[Authorization=\"Bearer \" & GetToken()]\r\n    ]\r\n    )),\r\n    token = Source[continuationToken],\r\n    currentData = Source[activityEventEntities],\r\n    data = {},\r\n    appendedData = List.Combine({data, currentData}),\r\n    output =  appendedData\r\nin\r\n    Source\r\nin\r\n    Source;\r\n\r\nshared GetActivityContinuationToken = let\r\n    Source = (continuationToken as any) =>\r\n    let\r\n    AlternativeList = [\r\n    activityEventEntities = {},\r\n    continuationUri = null,\r\n    continuationToken = null,\r\n    lastResultSet = \"TRUE\"\r\n    ],\r\n    Source = if continuationToken = null then AlternativeList else\r\n    Json.Document(Web.Contents(\"https://api.powerbi.com/v1.0/myorg/\",\r\n    [\r\n    RelativePath= \"admin/activityevents?continuationToken='\" & continuationToken & \"'\",\r\n    Headers=[Authorization=\"Bearer \" & GetToken()]\r\n    ]\r\n    ))\r\nin\r\n    Source\r\nin\r\n    Source;\r\n\r\nshared LoadActivityManual = let\r\n    BasicQuery= GetActivityBasicLoad(StartDate, EndDate),\r\n    ContinuationQuery_01 = GetActivityContinuationToken( BasicQuery[continuationToken] ),\r\n    ContinuationQuery_02 = GetActivityContinuationToken( ContinuationQuery_01[continuationToken] ),\r\n    ContinuationQuery_03 = GetActivityContinuationToken( ContinuationQuery_02[continuationToken] ),\r\n    ContinuationQuery_04 = GetActivityContinuationToken( ContinuationQuery_03[continuationToken] ),\r\n    ContinuationQuery_05 = GetActivityContinuationToken( ContinuationQuery_04[continuationToken] ),\r\n    ContinuationQuery_06 = GetActivityContinuationToken( ContinuationQuery_05[continuationToken] ),\r\n    ContinuationQuery_07 = GetActivityContinuationToken( ContinuationQuery_06[continuationToken] ),\r\n    ContinuationQuery_08 = GetActivityContinuationToken( ContinuationQuery_07[continuationToken] ),\r\n    ContinuationQuery_09 = GetActivityContinuationToken( ContinuationQuery_08[continuationToken] ),\r\n    ContinuationQuery_10 = GetActivityContinuationToken( ContinuationQuery_09[continuationToken] ),\r\n    ContinuationQuery_11 = GetActivityContinuationToken( ContinuationQuery_10[continuationToken] ),\r\n    ContinuationQuery_12 = GetActivityContinuationToken( ContinuationQuery_11[continuationToken] ),\r\n    ContinuationQuery_13 = GetActivityContinuationToken( ContinuationQuery_12[continuationToken] ),\r\n    ContinuationQuery_14 = GetActivityContinuationToken( ContinuationQuery_13[continuationToken] ),\r\n    ContinuationQuery_15 = GetActivityContinuationToken( ContinuationQuery_14[continuationToken] ),\r\n    ContinuationQuery_16 = GetActivityContinuationToken( ContinuationQuery_15[continuationToken] ),\r\n    ContinuationQuery_17 = GetActivityContinuationToken( ContinuationQuery_16[continuationToken] ),\r\n    ContinuationQuery_18 = GetActivityContinuationToken( ContinuationQuery_17[continuationToken] ),\r\n    ContinuationQuery_19 = GetActivityContinuationToken( ContinuationQuery_18[continuationToken] ),\r\n    ContinuationQuery_20 = GetActivityContinuationToken( ContinuationQuery_19[continuationToken] ),\r\n    ContinuationQuery_21 = GetActivityContinuationToken( ContinuationQuery_20[continuationToken] ),\r\n    ContinuationQuery_22 = GetActivityContinuationToken( ContinuationQuery_21[continuationToken] ),\r\n    ContinuationQuery_23 = GetActivityContinuationToken( ContinuationQuery_22[continuationToken] ),\r\n    ContinuationQuery_24 = GetActivityContinuationToken( ContinuationQuery_23[continuationToken] ),\r\n    ContinuationQuery_25 = GetActivityContinuationToken( ContinuationQuery_24[continuationToken] ),\r\n    ContinuationQuery_26 = GetActivityContinuationToken( ContinuationQuery_25[continuationToken] ),\r\n    ContinuationQuery_27 = GetActivityContinuationToken( ContinuationQuery_26[continuationToken] ),\r\n    ContinuationQuery_28 = GetActivityContinuationToken( ContinuationQuery_27[continuationToken] ),\r\n    ContinuationQuery_29 = GetActivityContinuationToken( ContinuationQuery_28[continuationToken] ),\r\n    ContinuationQuery_30 = GetActivityContinuationToken( ContinuationQuery_29[continuationToken] ),\r\n    ContinuationQuery_31 = GetActivityContinuationToken( ContinuationQuery_30[continuationToken] ),\r\n    ContinuationQuery_32 = GetActivityContinuationToken( ContinuationQuery_31[continuationToken] ),\r\n    ContinuationQuery_33 = GetActivityContinuationToken( ContinuationQuery_32[continuationToken] ),\r\n    ContinuationQuery_34 = GetActivityContinuationToken( ContinuationQuery_33[continuationToken] ),\r\n    ContinuationQuery_35 = GetActivityContinuationToken( ContinuationQuery_34[continuationToken] ),\r\n    ContinuationQuery_36 = GetActivityContinuationToken( ContinuationQuery_35[continuationToken] ),\r\n    ContinuationQuery_37 = GetActivityContinuationToken( ContinuationQuery_36[continuationToken] ),\r\n    ContinuationQuery_38 = GetActivityContinuationToken( ContinuationQuery_37[continuationToken] ),\r\n    ContinuationQuery_39 = GetActivityContinuationToken( ContinuationQuery_38[continuationToken] ),\r\n    ContinuationQuery_40 = GetActivityContinuationToken( ContinuationQuery_39[continuationToken] ),\r\n    ContinuationQuery_41 = GetActivityContinuationToken( ContinuationQuery_40[continuationToken] ),\r\n    ContinuationQuery_42 = GetActivityContinuationToken( ContinuationQuery_41[continuationToken] ),\r\n    ContinuationQuery_43 = GetActivityContinuationToken( ContinuationQuery_42[continuationToken] ),\r\n    ContinuationQuery_44 = GetActivityContinuationToken( ContinuationQuery_43[continuationToken] ),\r\n    ContinuationQuery_45 = GetActivityContinuationToken( ContinuationQuery_44[continuationToken] ),\r\n    ContinuationQuery_46 = GetActivityContinuationToken( ContinuationQuery_45[continuationToken] ),\r\n    ContinuationQuery_47 = GetActivityContinuationToken( ContinuationQuery_46[continuationToken] ),\r\n    ContinuationQuery_48 = GetActivityContinuationToken( ContinuationQuery_47[continuationToken] ),\r\n    ContinuationQuery_49 = GetActivityContinuationToken( ContinuationQuery_48[continuationToken] ),\r\n    ContinuationQuery_50 = GetActivityContinuationToken( ContinuationQuery_49[continuationToken] ),\r\n    ContinuationQuery_51 = GetActivityContinuationToken( ContinuationQuery_50[continuationToken] ),\r\n    ContinuationQuery_52 = GetActivityContinuationToken( ContinuationQuery_51[continuationToken] ),\r\n    ContinuationQuery_53 = GetActivityContinuationToken( ContinuationQuery_52[continuationToken] ),\r\n    ContinuationQuery_54 = GetActivityContinuationToken( ContinuationQuery_53[continuationToken] ),\r\n    ContinuationQuery_55 = GetActivityContinuationToken( ContinuationQuery_54[continuationToken] ),\r\n    ContinuationQuery_56 = GetActivityContinuationToken( ContinuationQuery_55[continuationToken] ),\r\n    ContinuationQuery_57 = GetActivityContinuationToken( ContinuationQuery_56[continuationToken] ),\r\n    ContinuationQuery_58 = GetActivityContinuationToken( ContinuationQuery_57[continuationToken] ),\r\n    ContinuationQuery_59 = GetActivityContinuationToken( ContinuationQuery_58[continuationToken] ),\r\n    ContinuationQuery_60 = GetActivityContinuationToken( ContinuationQuery_59[continuationToken] ),\r\n    ContinuationQuery_61 = GetActivityContinuationToken( ContinuationQuery_60[continuationToken] ),\r\n    ContinuationQuery_62 = GetActivityContinuationToken( ContinuationQuery_61[continuationToken] ),\r\n    ContinuationQuery_63 = GetActivityContinuationToken( ContinuationQuery_62[continuationToken] ),\r\n    ContinuationQuery_64 = GetActivityContinuationToken( ContinuationQuery_63[continuationToken] ),\r\n    ContinuationQuery_65 = GetActivityContinuationToken( ContinuationQuery_64[continuationToken] ),\r\n    ContinuationQuery_66 = GetActivityContinuationToken( ContinuationQuery_65[continuationToken] ),\r\n    ContinuationQuery_67 = GetActivityContinuationToken( ContinuationQuery_66[continuationToken] ),\r\n    ContinuationQuery_68 = GetActivityContinuationToken( ContinuationQuery_67[continuationToken] ),\r\n    ContinuationQuery_69 = GetActivityContinuationToken( ContinuationQuery_68[continuationToken] ),\r\n    ContinuationQuery_70 = GetActivityContinuationToken( ContinuationQuery_69[continuationToken] ),\r\n    ContinuationQuery_71 = GetActivityContinuationToken( ContinuationQuery_70[continuationToken] ),\r\n    ContinuationQuery_72 = GetActivityContinuationToken( ContinuationQuery_71[continuationToken] ),\r\n    ContinuationQuery_73 = GetActivityContinuationToken( ContinuationQuery_72[continuationToken] ),\r\n    ContinuationQuery_74 = GetActivityContinuationToken( ContinuationQuery_73[continuationToken] ),\r\n    ContinuationQuery_75 = GetActivityContinuationToken( ContinuationQuery_74[continuationToken] ),\r\n    Result = List.Union(\r\n    {\r\n    BasicQuery[activityEventEntities],\r\n    ContinuationQuery_01[activityEventEntities],\r\n    ContinuationQuery_02[activityEventEntities],\r\n    ContinuationQuery_03[activityEventEntities],\r\n    ContinuationQuery_04[activityEventEntities],\r\n    ContinuationQuery_05[activityEventEntities],\r\n    ContinuationQuery_06[activityEventEntities],\r\n    ContinuationQuery_07[activityEventEntities],\r\n    ContinuationQuery_08[activityEventEntities],\r\n    ContinuationQuery_09[activityEventEntities],\r\n    ContinuationQuery_10[activityEventEntities],\r\n    ContinuationQuery_11[activityEventEntities],\r\n    ContinuationQuery_12[activityEventEntities],\r\n    ContinuationQuery_13[activityEventEntities],\r\n    ContinuationQuery_14[activityEventEntities],\r\n    ContinuationQuery_15[activityEventEntities],\r\n    ContinuationQuery_16[activityEventEntities],\r\n    ContinuationQuery_17[activityEventEntities],\r\n    ContinuationQuery_18[activityEventEntities],\r\n    ContinuationQuery_19[activityEventEntities],\r\n    ContinuationQuery_20[activityEventEntities],\r\n    ContinuationQuery_21[activityEventEntities],\r\n    ContinuationQuery_22[activityEventEntities],\r\n    ContinuationQuery_23[activityEventEntities],\r\n    ContinuationQuery_24[activityEventEntities],\r\n    ContinuationQuery_25[activityEventEntities],\r\n    ContinuationQuery_26[activityEventEntities],\r\n    ContinuationQuery_27[activityEventEntities],\r\n    ContinuationQuery_28[activityEventEntities],\r\n    ContinuationQuery_29[activityEventEntities],\r\n    ContinuationQuery_30[activityEventEntities],\r\n    ContinuationQuery_31[activityEventEntities],\r\n    ContinuationQuery_32[activityEventEntities],\r\n    ContinuationQuery_33[activityEventEntities],\r\n    ContinuationQuery_34[activityEventEntities],\r\n    ContinuationQuery_35[activityEventEntities],\r\n    ContinuationQuery_36[activityEventEntities],\r\n    ContinuationQuery_37[activityEventEntities],\r\n    ContinuationQuery_38[activityEventEntities],\r\n    ContinuationQuery_39[activityEventEntities],\r\n    ContinuationQuery_40[activityEventEntities],\r\n    ContinuationQuery_41[activityEventEntities],\r\n    ContinuationQuery_42[activityEventEntities],\r\n    ContinuationQuery_43[activityEventEntities],\r\n    ContinuationQuery_44[activityEventEntities],\r\n    ContinuationQuery_45[activityEventEntities],\r\n    ContinuationQuery_46[activityEventEntities],\r\n    ContinuationQuery_47[activityEventEntities],\r\n    ContinuationQuery_48[activityEventEntities],\r\n    ContinuationQuery_49[activityEventEntities],\r\n    ContinuationQuery_50[activityEventEntities],\r\n    ContinuationQuery_51[activityEventEntities],\r\n    ContinuationQuery_52[activityEventEntities],\r\n    ContinuationQuery_53[activityEventEntities],\r\n    ContinuationQuery_54[activityEventEntities],\r\n    ContinuationQuery_55[activityEventEntities],\r\n    ContinuationQuery_56[activityEventEntities],\r\n    ContinuationQuery_57[activityEventEntities],\r\n    ContinuationQuery_58[activityEventEntities],\r\n    ContinuationQuery_59[activityEventEntities],\r\n    ContinuationQuery_60[activityEventEntities],\r\n    ContinuationQuery_61[activityEventEntities],\r\n    ContinuationQuery_62[activityEventEntities],\r\n    ContinuationQuery_63[activityEventEntities],\r\n    ContinuationQuery_64[activityEventEntities],\r\n    ContinuationQuery_65[activityEventEntities],\r\n    ContinuationQuery_66[activityEventEntities],\r\n    ContinuationQuery_67[activityEventEntities],\r\n    ContinuationQuery_68[activityEventEntities],\r\n    ContinuationQuery_69[activityEventEntities],\r\n    ContinuationQuery_70[activityEventEntities],\r\n    ContinuationQuery_71[activityEventEntities],\r\n    ContinuationQuery_72[activityEventEntities],\r\n    ContinuationQuery_73[activityEventEntities],\r\n    ContinuationQuery_74[activityEventEntities],\r\n    ContinuationQuery_75[activityEventEntities]\r\n    }\r\n    ),\r\n    #\"Converted to Table\" = Table.FromList(Result, Splitter.SplitByNothing(), null, null, ExtraValues.Error),\r\n    #\"Check if Table is Empty\"= Table.IsEmpty(#\"Converted to Table\"),\r\n    #\"Choose empty or filled table\" = if\r\n    Table.IsEmpty(#\"Converted to Table\")\r\n    then\r\n    #table(\r\n    { \"Id\", \"RecordType\", \"CreationTime\", \"Operation\", \"OrganizationId\", \"UserType\", \"UserKey\", \"Workload\", \"UserId\", \"ClientIP\", \"UserAgent\", \"Activity\", \"ItemName\", \"WorkSpaceName\", \"DatasetName\", \"ReportName\", \"WorkspaceId\", \"ObjectId\", \"DatasetId\", \"ReportId\", \"IsSuccess\", \"ReportType\", \"RequestId\", \"ActivityId\", \"DistributionMethod\", \"ConsumptionMethod\"},\r\n    {}\r\n    )\r\n    else\r\n    Table.ExpandRecordColumn(#\"Converted to Table\", \"Column1\", {\"Id\", \"RecordType\", \"CreationTime\", \"Operation\", \"OrganizationId\", \"UserType\", \"UserKey\", \"Workload\", \"UserId\", \"ClientIP\", \"UserAgent\", \"Activity\", \"ItemName\", \"WorkSpaceName\", \"DatasetName\", \"ReportName\", \"WorkspaceId\", \"ObjectId\", \"DatasetId\", \"ReportId\", \"IsSuccess\", \"ReportType\", \"RequestId\", \"ActivityId\", \"DistributionMethod\", \"ConsumptionMethod\"}, {\"Id\", \"RecordType\", \"CreationTime\", \"Operation\", \"OrganizationId\", \"UserType\", \"UserKey\", \"Workload\", \"UserId\", \"ClientIP\", \"UserAgent\", \"Activity\", \"ItemName\", \"WorkSpaceName\", \"DatasetName\", \"ReportName\", \"WorkspaceId\", \"ObjectId\", \"DatasetId\", \"ReportId\", \"IsSuccess\", \"ReportType\", \"RequestId\", \"ActivityId\", \"DistributionMethod\", \"ConsumptionMethod\"})\r\nin\r\n    #\"Choose empty or filled table\";\r\n\r\nshared ActivityManual = let\r\n    Source = List.Dates,\r\n    #\"Invoked FunctionSource\" = Source(Date.AddDays(DateTime.Date(DateTime.FixedLocalNow()), -AmountOfDays), AmountOfDays, #duration(1, 0, 0, 0)),\r\n    #\"Converted to Table\" = Table.FromList(#\"Invoked FunctionSource\", Splitter.SplitByNothing(), null, null, ExtraValues.Error),\r\n    #\"Renamed Columns\" = Table.RenameColumns(#\"Converted to Table\",{{\"Column1\", \"Date\"}}),\r\n    #\"Added Custom\" = Table.AddColumn(#\"Renamed Columns\", \"StartDate\", each \"'\"\r\n    & Date.ToText([Date], \"YYYY-MM-DD\")\r\n    & \"T00:00:00.000Z\"\r\n    & \"'\"),\r\n    #\"Added Custom1\" = Table.AddColumn(#\"Added Custom\", \"EndDate\", each \"'\"\r\n    & Date.ToText([Date], \"YYYY-MM-DD\")\r\n    & \"T23:59:59.999Z\"\r\n    & \"'\"),\r\n    #\"Invoked Custom Function\" = Table.AddColumn(#\"Added Custom1\", \"LoadActivityManual\", each GetActivityManual([StartDate], [EndDate])),\r\n    #\"Expanded GetActivity\" = Table.ExpandListColumn(#\"Invoked Custom Function\", \"LoadActivityManual\"),\r\n    #\"Expanded LoadActivityManual\" = Table.ExpandRecordColumn(#\"Expanded GetActivity\", \"LoadActivityManual\", {\"Id\", \"RecordType\", \"CreationTime\", \"Operation\", \"OrganizationId\", \"UserType\", \"UserKey\", \"Workload\", \"UserId\", \"ClientIP\", \"UserAgent\", \"Activity\", \"ItemName\", \"WorkSpaceName\", \"DatasetName\", \"ReportName\", \"WorkspaceId\", \"ObjectId\", \"DatasetId\", \"ReportId\", \"IsSuccess\", \"ReportType\", \"RequestId\", \"ActivityId\", \"DistributionMethod\", \"ConsumptionMethod\"}, {\"Id\", \"RecordType\", \"CreationTime\", \"Operation\", \"OrganizationId\", \"UserType\", \"UserKey\", \"Workload\", \"UserId\", \"ClientIP\", \"UserAgent\", \"Activity\", \"ItemName\", \"WorkSpaceName\", \"DatasetName\", \"ReportName\", \"WorkspaceId\", \"ObjectId\", \"DatasetId\", \"ReportId\", \"IsSuccess\", \"ReportType\", \"RequestId\", \"ActivityId\", \"DistributionMethod\", \"ConsumptionMethod\"}),\r\n    #\"Removed Columns\" = Table.RemoveColumns(#\"Expanded LoadActivityManual\",{\"StartDate\", \"EndDate\"}),\r\n    #\"Changed Type\" = Table.TransformColumnTypes(#\"Removed Columns\",{{\"Date\", type date}, {\"CreationTime\", type datetime}}),\r\n    #\"Renamed Columns1\" = Table.RenameColumns(#\"Changed Type\",{{\"CreationTime\", \"CreationDate\"}}),\r\n    #\"Inserted Time\" = Table.AddColumn(#\"Renamed Columns1\", \"CreationTime\", each Time.From([CreationDate]), type time),\r\n    #\"Reordered Columns\" = Table.ReorderColumns(#\"Inserted Time\",{\"Date\", \"Id\", \"RecordType\", \"CreationDate\", \"CreationTime\", \"Operation\", \"OrganizationId\", \"UserType\", \"UserKey\", \"Workload\", \"UserId\", \"ClientIP\", \"UserAgent\", \"Activity\", \"ItemName\", \"WorkSpaceName\", \"DatasetName\", \"ReportName\", \"WorkspaceId\", \"ObjectId\", \"DatasetId\", \"ReportId\", \"IsSuccess\", \"ReportType\", \"RequestId\", \"ActivityId\", \"DistributionMethod\"}),\r\n    #\"Sorted Rows\" = Table.Sort(#\"Reordered Columns\",{{\"Date\", Order.Descending}}),\r\n    #\"Changed column type\" = Table.TransformColumnTypes(#\"Sorted Rows\", {{\"Date\", type date}, {\"Id\", type text}, {\"RecordType\", Int64.Type}, {\"CreationTime\", type time}, {\"Operation\", type text}, {\"OrganizationId\", type text}, {\"UserType\", Int64.Type}, {\"UserKey\", type text}, {\"Workload\", type text}, {\"UserId\", type text}, {\"ClientIP\", type text}, {\"UserAgent\", type text}, {\"Activity\", type text}, {\"ItemName\", type text}, {\"WorkSpaceName\", type text}, {\"DatasetName\", type text}, {\"ReportName\", type any}, {\"WorkspaceId\", type text}, {\"ObjectId\", type text}, {\"DatasetId\", type text}, {\"ReportId\", type any}, {\"IsSuccess\", type logical}, {\"ReportType\", type any}, {\"RequestId\", type text}, {\"ActivityId\", type text}, {\"ConsumptionMethod\", type any}, {\"DistributionMethod\", type any}}),\r\n    #\"Changed column type 1\" = Table.TransformColumnTypes(#\"Changed column type\", {{\"DistributionMethod\", type text}, {\"ConsumptionMethod\", type text}, {\"ReportType\", type text}, {\"ReportId\", type text}, {\"DatasetId\", type text}, {\"ReportName\", type text}}),\r\n    #\"Renamed columns 1\" = Table.RenameColumns(#\"Changed column type 1\", {{\"Date\", \"CreationDateOnly\"}}),\r\n    #\"ActivityManual-4372656174696F6E44617465-autogenerated_for_incremental_refresh\" = Table.SelectRows(#\"Renamed columns 1\", each DateTime.From([CreationDate]) >= RangeStart and DateTime.From([CreationDate]) < RangeEnd)\r\nin\r\n    #\"ActivityManual-4372656174696F6E44617465-autogenerated_for_incremental_refresh\";\r\n\r\nshared RangeStart = let RangeStart = #datetime(0001,01,01,00,00,00) meta [IsParameterQuery=true, List={}, Type=\"DateTime\", IsParameterQueryRequired=true, Description=\"autogenerated_for_incremental_refresh\"] in RangeStart;\r\n\r\nshared RangeEnd = let RangeEnd = #datetime(9999,12,31,23,59,59) meta [IsParameterQuery=true, List={}, Type=\"DateTime\", IsParameterQueryRequired=true, Description=\"autogenerated_for_incremental_refresh\"] in RangeEnd;\r\n\r\n","connectionOverrides":[{"path":"https://api.powerbi.com/v1.0/myorg","kind":"Web","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Web\",\"path\":\"https://api.powerbi.com/v1.0/myorg\"}","audience":null},{"path":"https://login.microsoftonline.com/4510a959-aa93-4f35-a3f5-e2249f4d35f6/oauth2/token","kind":"Web","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Web\",\"path\":\"https://login.microsoftonline.com/4510a959-aa93-4f35-a3f5-e2249f4d35f6/oauth2/token\"}","audience":null},{"path":"https://login.microsoftonline.com/8c39a7ff-e077-4d1c-9a1c-7431fe5eb465/oauth2/token","kind":"Web","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Web\",\"path\":\"https://login.microsoftonline.com/8c39a7ff-e077-4d1c-9a1c-7431fe5eb465/oauth2/token\"}","audience":null}]},"annotations":[{"name":"pbi:QueryGroups","value":"[{\"id\":\"40ddf872-7938-4986-903f-0455b6657d6b\",\"name\":\"parameters\",\"description\":\"\",\"parentId\":null,\"order\":1},{\"id\":\"72b09c02-e9d7-4cfa-b355-33e3790eb128\",\"name\":\"act\",\"description\":\"\",\"parentId\":null,\"order\":0},{\"id\":\"50ca40b4-d121-490d-ada5-30a6efc5fac0\",\"name\":\"scanner\",\"description\":\"\",\"parentId\":null,\"order\":0}]"}],"entities":[{"$type":"LocalEntity","name":"WorkspaceList","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"WorkspaceList.csv"},"attributes":[{"name":"Column1.id","dataType":"string"}],"partitions":[{"name":"FullRefreshPolicyPartition","refreshTime":"2022-11-09T20:56:34.2335193+00:00","location":"https://wabincushpcdsap1.blob.core.windows.net:443/e8762967-6163-4533-ab0d-5bb492c8d3d7/WorkspaceList.csv?snapshot=2022-11-09T20%3A56%3A34.2770403Z"}]},{"$type":"LocalEntity","name":"scanResults","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"scanResults.csv"},"attributes":[{"name":"Name","dataType":"string"},{"name":"Value","dataType":"string"}],"partitions":[{"name":"FullRefreshPolicyPartition","refreshTime":"2022-11-09T20:56:31.5921016+00:00","location":"https://wabincushpcdsap1.blob.core.windows.net:443/e8762967-6163-4533-ab0d-5bb492c8d3d7/scanResults.csv?snapshot=2022-11-09T20%3A56%3A31.6145594Z"}]},{"$type":"LocalEntity","name":"getScanIDWS","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"getScanIDWS.csv"},"attributes":[{"name":"workspaceID","dataType":"string"},{"name":"id","dataType":"string"},{"name":"createdDateTime","dataType":"dateTime"},{"name":"status","dataType":"string"}],"partitions":[{"name":"FullRefreshPolicyPartition","refreshTime":"2022-11-09T20:56:34.0772299+00:00","location":"https://wabincushpcdsap1.blob.core.windows.net:443/e8762967-6163-4533-ab0d-5bb492c8d3d7/getScanIDWS.csv?snapshot=2022-11-09T20%3A56%3A34.1151316Z"}]},{"$type":"LocalEntity","name":"ActivityManual","description":"","pbi:refreshPolicy":{"$type":"IncrementalRefreshPolicy","locationPattern":"ActivityManual/part.csv","rollingWindowGranularity":"year","rollingWindowPeriods":3,"incrementalGranularity":"day","incrementalPeriods":2},"annotations":[{"name":"pbi:IncrementalRefreshDetectChangeAttribute"},{"name":"pbi:IncrementalRefreshFilterByAttribute","value":"CreationDate"}],"attributes":[{"name":"CreationDateOnly","dataType":"date"},{"name":"Id","dataType":"string"},{"name":"RecordType","dataType":"int64"},{"name":"CreationDate","dataType":"dateTime"},{"name":"CreationTime","dataType":"time"},{"name":"Operation","dataType":"string"},{"name":"OrganizationId","dataType":"string"},{"name":"UserType","dataType":"int64"},{"name":"UserKey","dataType":"string"},{"name":"Workload","dataType":"string"},{"name":"UserId","dataType":"string"},{"name":"ClientIP","dataType":"string"},{"name":"UserAgent","dataType":"string"},{"name":"Activity","dataType":"string"},{"name":"ItemName","dataType":"string"},{"name":"WorkSpaceName","dataType":"string"},{"name":"DatasetName","dataType":"string"},{"name":"ReportName","dataType":"string"},{"name":"WorkspaceId","dataType":"string"},{"name":"ObjectId","dataType":"string"},{"name":"DatasetId","dataType":"string"},{"name":"ReportId","dataType":"string"},{"name":"IsSuccess","dataType":"boolean"},{"name":"ReportType","dataType":"string"},{"name":"RequestId","dataType":"string"},{"name":"ActivityId","dataType":"string"},{"name":"ConsumptionMethod","dataType":"string"},{"name":"DistributionMethod","dataType":"string"}],"partitions":[{"name":"IncrementalRefreshPolicyPartition-2019","refreshTime":"2022-11-09T21:47:53.2578375+00:00","location":"https://wabincushpcdsap1.blob.core.windows.net:443/e8762967-6163-4533-ab0d-5bb492c8d3d7/ActivityManual/part-2019.csv?snapshot=2022-11-09T21%3A47%3A53.2720730Z","pbi:source":{"$type":"RangePolicyPartitionSource","start":"2019-01-01T00:00:00","end":"2020-01-01T00:00:00"}},{"name":"IncrementalRefreshPolicyPartition-2020","refreshTime":"2022-11-09T21:47:44.3656607+00:00","location":"https://wabincushpcdsap1.blob.core.windows.net:443/e8762967-6163-4533-ab0d-5bb492c8d3d7/ActivityManual/part-2020.csv?snapshot=2022-11-09T21%3A47%3A44.3861412Z","pbi:source":{"$type":"RangePolicyPartitionSource","start":"2020-01-01T00:00:00","end":"2021-01-01T00:00:00"}},{"name":"IncrementalRefreshPolicyPartition-2021","refreshTime":"2022-11-09T21:47:52.3045731+00:00","location":"https://wabincushpcdsap1.blob.core.windows.net:443/e8762967-6163-4533-ab0d-5bb492c8d3d7/ActivityManual/part-2021.csv?snapshot=2022-11-09T21%3A47%3A52.3216146Z","pbi:source":{"$type":"RangePolicyPartitionSource","start":"2021-01-01T00:00:00","end":"2022-01-01T00:00:00"}},{"name":"IncrementalRefreshPolicyPartition-2022Q1","refreshTime":"2022-11-09T21:47:56.5239051+00:00","location":"https://wabincushpcdsap1.blob.core.windows.net:443/e8762967-6163-4533-ab0d-5bb492c8d3d7/ActivityManual/part-2022Q1.csv?snapshot=2022-11-09T21%3A47%3A56.5482039Z","pbi:source":{"$type":"RangePolicyPartitionSource","start":"2022-01-01T00:00:00","end":"2022-04-01T00:00:00"}},{"name":"IncrementalRefreshPolicyPartition-2022Q2","refreshTime":"2022-11-09T21:47:46.3035512+00:00","location":"https://wabincushpcdsap1.blob.core.windows.net:443/e8762967-6163-4533-ab0d-5bb492c8d3d7/ActivityManual/part-2022Q2.csv?snapshot=2022-11-09T21%3A47%3A46.3330310Z","pbi:source":{"$type":"RangePolicyPartitionSource","start":"2022-04-01T00:00:00","end":"2022-07-01T00:00:00"}},{"name":"IncrementalRefreshPolicyPartition-2022Q3","refreshTime":"2022-11-09T21:47:28.456503+00:00","location":"https://wabincushpcdsap1.blob.core.windows.net:443/e8762967-6163-4533-ab0d-5bb492c8d3d7/ActivityManual/part-2022Q3.csv?snapshot=2022-11-09T21%3A47%3A28.4792156Z","pbi:source":{"$type":"RangePolicyPartitionSource","start":"2022-07-01T00:00:00","end":"2022-10-01T00:00:00"}},{"name":"IncrementalRefreshPolicyPartition-2022Q410","refreshTime":"2022-11-09T21:47:56.1019791+00:00","location":"https://wabincushpcdsap1.blob.core.windows.net:443/e8762967-6163-4533-ab0d-5bb492c8d3d7/ActivityManual/part-2022Q410.csv?snapshot=2022-11-09T21%3A47%3A56.1264447Z","pbi:source":{"$type":"RangePolicyPartitionSource","start":"2022-10-01T00:00:00","end":"2022-11-01T00:00:00"}},{"name":"IncrementalRefreshPolicyPartition-2022Q41101","refreshTime":"2022-11-09T21:47:34.6297105+00:00","location":"https://wabincushpcdsap1.blob.core.windows.net:443/e8762967-6163-4533-ab0d-5bb492c8d3d7/ActivityManual/part-2022Q41101.csv?snapshot=2022-11-09T21%3A47%3A34.6496959Z","pbi:source":{"$type":"RangePolicyPartitionSource","start":"2022-11-01T00:00:00","end":"2022-11-02T00:00:00"}},{"name":"IncrementalRefreshPolicyPartition-2022Q41102","refreshTime":"2022-11-09T21:47:25.8622588+00:00","location":"https://wabincushpcdsap1.blob.core.windows.net:443/e8762967-6163-4533-ab0d-5bb492c8d3d7/ActivityManual/part-2022Q41102.csv?snapshot=2022-11-09T21%3A47%3A25.8846942Z","pbi:source":{"$type":"RangePolicyPartitionSource","start":"2022-11-02T00:00:00","end":"2022-11-03T00:00:00"}},{"name":"IncrementalRefreshPolicyPartition-2022Q41103","refreshTime":"2022-11-09T21:47:50.3355129+00:00","location":"https://wabincushpcdsap1.blob.core.windows.net:443/e8762967-6163-4533-ab0d-5bb492c8d3d7/ActivityManual/part-2022Q41103.csv?snapshot=2022-11-09T21%3A47%3A50.3677289Z","pbi:source":{"$type":"RangePolicyPartitionSource","start":"2022-11-03T00:00:00","end":"2022-11-04T00:00:00"}},{"name":"IncrementalRefreshPolicyPartition-2022Q41104","refreshTime":"2022-11-09T21:47:55.8208713+00:00","location":"https://wabincushpcdsap1.blob.core.windows.net:443/e8762967-6163-4533-ab0d-5bb492c8d3d7/ActivityManual/part-2022Q41104.csv?snapshot=2022-11-09T21%3A47%3A55.8296141Z","pbi:source":{"$type":"RangePolicyPartitionSource","start":"2022-11-04T00:00:00","end":"2022-11-05T00:00:00"}},{"name":"IncrementalRefreshPolicyPartition-2022Q41105","refreshTime":"2022-11-09T21:47:59.6040323+00:00","location":"https://wabincushpcdsap1.blob.core.windows.net:443/e8762967-6163-4533-ab0d-5bb492c8d3d7/ActivityManual/part-2022Q41105.csv?snapshot=2022-11-09T21%3A47%3A59.6214507Z","pbi:source":{"$type":"RangePolicyPartitionSource","start":"2022-11-05T00:00:00","end":"2022-11-06T00:00:00"}},{"name":"IncrementalRefreshPolicyPartition-2022Q41106","refreshTime":"2022-11-09T21:47:39.8493321+00:00","location":"https://wabincushpcdsap1.blob.core.windows.net:443/e8762967-6163-4533-ab0d-5bb492c8d3d7/ActivityManual/part-2022Q41106.csv?snapshot=2022-11-09T21%3A47%3A39.8797120Z","pbi:source":{"$type":"RangePolicyPartitionSource","start":"2022-11-06T00:00:00","end":"2022-11-07T00:00:00"}},{"name":"IncrementalRefreshPolicyPartition-2022Q41107","refreshTime":"2022-11-09T21:47:44.7094763+00:00","location":"https://wabincushpcdsap1.blob.core.windows.net:443/e8762967-6163-4533-ab0d-5bb492c8d3d7/ActivityManual/part-2022Q41107.csv?snapshot=2022-11-09T21%3A47%3A44.7259481Z","pbi:source":{"$type":"RangePolicyPartitionSource","start":"2022-11-07T00:00:00","end":"2022-11-08T00:00:00"}},{"name":"IncrementalRefreshPolicyPartition-2022Q41108","refreshTime":"2022-11-09T21:47:51.4294371+00:00","location":"https://wabincushpcdsap1.blob.core.windows.net:443/e8762967-6163-4533-ab0d-5bb492c8d3d7/ActivityManual/part-2022Q41108.csv?snapshot=2022-11-09T21%3A47%3A51.4311226Z","pbi:source":{"$type":"RangePolicyPartitionSource","start":"2022-11-08T00:00:00","end":"2022-11-09T00:00:00"}},{"name":"IncrementalRefreshPolicyPartition-2022Q41109","refreshTime":"2022-11-09T21:47:55.6956813+00:00","location":"https://wabincushpcdsap1.blob.core.windows.net:443/e8762967-6163-4533-ab0d-5bb492c8d3d7/ActivityManual/part-2022Q41109.csv?snapshot=2022-11-09T21%3A47%3A55.6806989Z","pbi:source":{"$type":"RangePolicyPartitionSource","start":"2022-11-09T00:00:00","end":"2022-11-10T00:00:00"}}]}]}